(self.webpackChunkindk=self.webpackChunkindk||[]).push([[464],{2464:(t,e,a)=>{"use strict";a.r(e),a.d(e,{LoginModule:()=>w});var n=a(8583),i=a(6304),o=a(3679),s=a(2340),r=a(7716),l=a(5970),u=a(474),c=a(4655),g=a(9517),d=a(5236),h=a(1209),p=a(9016),m=a(8295),f=a(9983),Z=a(1095);function k(t,e){1&t&&r._UZ(0,"i",21)}function v(t,e){1&t&&r._UZ(0,"i",22)}const b=a(2527);let y=(()=>{class t{constructor(t,e,a,n,i,r,l){this.al=t,this.auth=e,this.router=a,this.ms=n,this.api=i,this.usuarios=r,this.db=l,this.emailValid=new o.NI("",[o.kI.required,o.kI.email]),this.passwordValid=new o.NI("",[o.kI.required]),this.show=!1,this.email="",this.senha="",this.conn=!1,this.login={email:"",senha:""},this.authResult={token:"",iduser:"",email:"",tipusuario:""},this.logo=s.N.pathassets+"/imagens/IndK.png";let u=localStorage.getItem("tipoUser");"E"==u?this.router.navigate(["/home"]):"C"==u&&this.router.navigate(["/home-client"])}password(){this.show=!this.show}ngOnInit(){var t=this;return(0,i.Z)(function*(){localStorage.getItem("tipoUser")||(yield t.logout())})()}logout(){var t=this;return(0,i.Z)(function*(){yield t.auth.logout().then(()=>{t.router.navigate(["/login"])})})()}logar(){var t=this;return(0,i.Z)(function*(){t.validaCampos()&&(t.conn=!0,t.login.email=t.email,t.login.senha=b.AES.encrypt(t.senha,s.N.secr).toString(),yield t.auth.login(t.login).then(function(){var e=(0,i.Z)(function*(e){e&&(t.authResult={token:e.token.token,iduser:e.tokenData.iduser,email:e.tokenData.email,tipusuario:e.tokenData.tipusuario},localStorage.setItem("token",e.token.token),yield t.auth.setSession(t.authResult),t.auth.setLogin=!1,yield t.auth.isLoggedIn(t.router).then((0,i.Z)(function*(){localStorage.setItem("tipoUser",e.tokenData.tipusuario),yield t.db.set("iduser",e.tokenData.iduser),yield t.db.set("email",e.tokenData.email),t.router.navigate("C"===e.tokenData.tipusuario?["/home-client"]:["/home"])})))});return function(t){return e.apply(this,arguments)}}()).catch(e=>{t.conn=!1,t.logout(),t.al.openSnackBar("Email e/ou senha incorreto(s).","custom-style-denied")}))})()}validaCampos(){return""!==this.email&&""!==this.senha||(this.al.openSnackBar("Por favor, preencha todos os campos!","custom-style-denied"),!1)}registrar(){this.router.navigate(["/registrar"])}redefinir(){this.router.navigate(["/reset"])}getAvatar(){var t=this;return(0,i.Z)(function*(){let e=yield t.usuarios.usuarioFindByMail(t.email);e&&e.avatarblob&&"assets/imagens/nophoto.png"!==e.avatarblob?document.getElementById("avatarLogin").setAttribute("src",URL.createObjectURL(e.avatarblob)):document.getElementById("avatarLogin").setAttribute("src","assets/imagens/nophoto.png")})()}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(l.c),r.Y36(u.e),r.Y36(c.F0),r.Y36(g.FF),r.Y36(d.s),r.Y36(h.J),r.Y36(p.M))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-login"]],decls:31,vars:7,consts:[[1,"box"],["id","background"],[1,"whitecard"],[1,"logo"],["src","assets/imagens/IndK.png"],[1,"avatar"],["id","avatarLogin","src","assets/imagens/nophoto.png"],[1,"login-section-body"],["appearance","fill"],[1,"label"],[1,"fa-solid","fa-envelope"],["type","email","matInput","",1,"input",3,"ngModel","formControl","ngModelChange","blur"],[1,"fa-solid","fa-lock"],["matInput","",1,"input",3,"ngModel","type","formControl","ngModelChange"],[1,"eye",3,"click"],["class","fa-solid fa-eye",4,"ngIf"],["class","fa-solid fa-eye-slash",4,"ngIf"],[1,"link",2,"margin-left","17%",3,"click"],[1,"btns-l"],["mat-stroked-button","",3,"click"],[1,"link",3,"click"],[1,"fa-solid","fa-eye"],[1,"fa-solid","fa-eye-slash"]],template:function(t,e){1&t&&(r.TgZ(0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"div",2),r.TgZ(3,"div",3),r._UZ(4,"img",4),r.qZA(),r.TgZ(5,"div",5),r._UZ(6,"img",6),r.qZA(),r.TgZ(7,"section",7),r.TgZ(8,"mat-form-field",8),r.TgZ(9,"mat-label",9),r._UZ(10,"i",10),r._uU(11," Email"),r.qZA(),r.TgZ(12,"input",11),r.NdJ("ngModelChange",function(t){return e.email=t})("blur",function(){return e.getAvatar()}),r.qZA(),r.qZA(),r.TgZ(13,"mat-form-field",8),r.TgZ(14,"mat-label",9),r._UZ(15,"i",12),r._uU(16," Senha"),r.qZA(),r.TgZ(17,"input",13),r.NdJ("ngModelChange",function(t){return e.senha=t}),r.qZA(),r.TgZ(18,"a",14),r.NdJ("click",function(){return e.password()}),r.YNc(19,k,1,0,"i",15),r.YNc(20,v,1,0,"i",16),r.qZA(),r.qZA(),r.TgZ(21,"mat-label",17),r.NdJ("click",function(){return e.redefinir()}),r._uU(22," Esqueceu sua senha? "),r.qZA(),r.TgZ(23,"div",18),r.TgZ(24,"button",19),r.NdJ("click",function(){return e.logar()}),r._uU(25,"Logar"),r.qZA(),r.qZA(),r.TgZ(26,"div",18),r.TgZ(27,"mat-label"),r._uU(28,"Novo por aqui?"),r.qZA(),r.TgZ(29,"mat-label",20),r.NdJ("click",function(){return e.registrar()}),r._uU(30," Criar Cadastro "),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&t&&(r.xp6(12),r.Q6J("ngModel",e.email)("formControl",e.emailValid),r.xp6(5),r.Q6J("ngModel",e.senha)("type",e.show?"text":"password")("formControl",e.passwordValid),r.xp6(2),r.Q6J("ngIf",e.show),r.xp6(1),r.Q6J("ngIf",!e.show))},directives:[m.KE,m.hX,f.Nt,o.Fj,o.JJ,o.oH,n.O5,Z.lW],styles:[".label-esqsenha[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;font-size:14px;color:#1796e6;cursor:pointer;padding-left:8px}.eye[_ngcontent-%COMP%]{color:#434343;position:absolute;right:0}"]}),t})();const A=[{path:"",component:y}];let q=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[c.Bz.forChild(A)],c.Bz]}),t})();var I=a(3635);let w=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t,bootstrap:[y]}),t.\u0275inj=r.cJS({imports:[[n.ez,q,I.N]]}),t})()}}]);